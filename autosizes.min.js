const defaults={targetElementClass:"autosizes",processedElementClass:"autosized",sizesAttr:"sizes",minSize:40,init:!0,resizeDebounce:99};let config={...defaults};function initConfig(){const t=window.autoSizesConfig||{};config={...defaults,...t}}function getWidth(t,e,i){for(i=i||t.offsetWidth;i<config.minSize&&e&&!t._autosizesWidth;)i=e.offsetWidth,e=e.parentNode;return i}function debounce(t){let e,i;const n=config.resizeDebounce,s=()=>{e=null,t()},o=()=>{const t=Date.now()-i;t<n?e=setTimeout(o,n-t):window.requestIdleCallback?requestIdleCallback(s):s()};return()=>{i=Date.now(),e||(e=setTimeout(o,n))}}const rAF=(()=>{let t=!1,e=!1;const i=[],n=()=>{for(t=!0,e=!1;i.length;){i.shift()()}t=!1};return s=>{t?s():(i.push(s),e||(e=!0,requestAnimationFrame(n)))}})();function rAFIt(t){return function(...e){rAF(()=>{t.apply(this,e)})}}function triggerEvent(t,e,i={}){const n=new CustomEvent(e,{detail:i,bubbles:!0,cancelable:!0});return t.dispatchEvent(n),n}function hasPrefix(t){return t.includes("-")&&"sizes"!==t}function getBaseAttr(t){if(hasPrefix(t)){const e=t.split("-");return e[e.length-1]}return t}const autoSizer=(()=>{let t;const e=rAFIt((t,e,i,n)=>{t._autosizesWidth=n;const s=`${n}px`;(t=>"auto"===t.getAttribute(config.sizesAttr))(t)&&((t,e)=>{if(t.setAttribute(config.sizesAttr,e),hasPrefix(config.sizesAttr)){const i=getBaseAttr(config.sizesAttr);t.setAttribute(i,e)}})(t,s),config.processedElementClass&&t.classList.add(config.processedElementClass),triggerEvent(t,"afterSizesUpdate",{width:n,sizes:s})}),i=(t,i,n)=>{const s=t.parentNode;if(!s)return;const o=triggerEvent(t,"beforeSizesUpdate",{width:n=getWidth(t,s,n),dataAttr:!!i});o.defaultPrevented||(n=o.detail.width)&&n!==t._autosizesWidth&&e(t,s,o,n)},n=()=>{if(t&&t.length)for(let e=0;e<t.length;e++)i(t[e])},s=debounce(n);return{init:()=>{t=document.getElementsByClassName(config.targetElementClass),window.addEventListener("resize",s),n()},updateAll:s,updateElem:i}})();function init(){init.initialized||(init.initialized=!0,initConfig(),autoSizer.init())}const autoSizes={cfg:config,autoSizer:autoSizer,init:init,updateAll:()=>autoSizer.updateAll(),updateElem:t=>autoSizer.updateElem(t)};export default autoSizes;